!!!
%html{:lang => "en"}
  %head
    %meta{:charset => "utf-8"}
    %meta{:content => "IE=edge", "http-equiv" => "X-UA-Compatible"}
    %meta{:content => "width=device-width, initial-scale=1", :name => "viewport"}
    %meta{:content => "", :name => "description"}
    %meta{:content => "", :name => "author"}
    %title Somnang Phoneshop Admin Panel
    = stylesheet_link_tag "admin/dashboard"
    / HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries
    / WARNING: Respond.js doesn't work if you view the page via file://
    /[if lt IE 9]
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    
    = csrf_meta_tags
  %body
    #wrapper
      = render 'shared/admin/navbar'
      #page-wrapper
        .row
          .col-xs-12
            = yield

    = javascript_include_tag "admin/dashboard"

    :javascript
      var advancedEditor, authorship, basicEditor, cursorManager, _;

      _ = Quill.require('lodash');

      advancedEditor = new Quill('.advanced-wrapper .editor-container', {
        modules: {
          'authorship': {
            authorId: 'advanced',
            enabled: true
          },
          'toolbar': {
            container: '.advanced-wrapper .toolbar-container'
          },
          'link-tooltip': true,
          'image-tooltip': true,
          'multi-cursor': true
        },
        styles: false,
        theme: 'snow'
      });

      authorship = advancedEditor.getModule('authorship');

      authorship.addAuthor('basic', 'rgba(255,153,51,0.4)');

      cursorManager = advancedEditor.getModule('multi-cursor');

      cursorManager.setCursor('basic', 0, 'basic', 'rgba(255,153,51,0.9)');

      basicEditor.on('selection-change', function(range) {
        console.info('basic', 'selection', range);
        if (range != null) {
          return cursorManager.moveCursor('basic', range.end);
        }
      });

      basicEditor.on('text-change', function(delta, source) {
        var sourceDelta, targetDelta;
        if (source === 'api') {
          return;
        }
        console.info('basic', 'text', delta, source);
        advancedEditor.updateContents(delta);
        sourceDelta = basicEditor.getContents();
        targetDelta = advancedEditor.getContents();
        return console.assert(_.isEqual(sourceDelta, targetDelta), "Editor diversion!", sourceDelta.ops, targetDelta.ops);
      });

      advancedEditor.on('selection-change', function(range) {
        return console.info('advanced', 'selection', range);
      });

      advancedEditor.on('text-change', function(delta, source) {
        var sourceDelta, targetDelta;
        if (source === 'api') {
          return;
        }
        console.info('advanced', 'text', delta, source);
        basicEditor.updateContents(delta);
        sourceDelta = advancedEditor.getContents();
        targetDelta = basicEditor.getContents();
        return console.assert(_.isEqual(sourceDelta, targetDelta), "Editor diversion!", sourceDelta.ops, targetDelta.ops);
      });
